/* Automatically generated, using 
Q = 
* 40 0 0 0 0 0 0 0 0
* 0 40 0 0 0 0 0 0 0
* 0 0 40 0 0 0 0 0 0
* 0 0 0 4.000000e-02 0 0 0 0 0
* 0 0 0 0 4.000000e-02 0 0 0 0
* 0 0 0 0 0 4.000000e-02 0 0 0
* 0 0 0 0 0 0 6.714924e-04 0 0
* 0 0 0 0 0 0 0 6.714924e-04 0
* 0 0 0 0 0 0 0 0 6.714924e-04
R = 
* 9.121488e+00 0 0
* 0 9.121488e+00 0
* 0 0 9.121488e+00
*/

#include "attitude.h"
#include <math.h>  /* sqrt */

/*
 * @note    This is an automatically generated function. Do not edit it here,
 *          edit it in the template, or in the MATLAB code generator.
 */
void getControllerOutput(const ReducedStateX x_hat_r,
                         const ReferenceQuaternion ref, ControllerOutputU u) {
    /* Calculate the real part of the quaternion from the reduced state. */
    double xq0 = sqrt(1.0 - x_hat_r[0] * x_hat_r[0] - x_hat_r[1] * x_hat_r[1] -
                      x_hat_r[2] * x_hat_r[2]);
    /* Generated calculations for control signal. */
    u[0]       = 0.03044168315113261*ref[2 - 1] - 6.7247664968252736e-19*ref[1 - 1] + 3.6910219414056335e-18*ref[3 - 1] - 1.0592638019682094e-18*ref[4 - 1] - 0.13010174131559896*x_hat_r[4 - 1] - 0.010187527568710443*x_hat_r[7 - 1] - 1.941382079057852*x_hat_r[2 - 1]*(0.0000000000000011644026282695439*ref[1 - 1] - 0.000000000000000068754933253161542*ref[2 - 1] + 0.000000000000000017599558688730133*ref[3 - 1] - 0.55555555555555556*ref[4 - 1]) + 1.941382079057852*x_hat_r[3 - 1]*(2.0171620859552303e-18*ref[1 - 1] + 0.000000000000000012195809172013759*ref[2 - 1] - 0.55555555555555556*ref[3 - 1] + 0.000000000000000017783414524861269*ref[4 - 1]) - 1.941382079057852*x_hat_r[1 - 1]*(0.5*ref[1 - 1] + 0.000000000000000015518717593798804*ref[2 - 1] - 0.000000000000000027332744408243554*ref[3 - 1] - 0.0000000000000011446064366055788*ref[4 - 1]) - 1.941382079057852*xq0*(1.227258482580373e-18*ref[1 - 1] - 0.55555555555555556*ref[2 - 1] - 6.7360524549348324e-18*ref[3 - 1] + 1.9331384768073952e-18*ref[4 - 1]);
    u[1]       = 0.031066285656089344*ref[3 - 1] - 6.8198128478088121e-18*ref[2 - 1] - 1.1279832043845284e-18*ref[1 - 1] - 9.9443634402597955e-18*ref[4 - 1] - 0.1325875659416843*x_hat_r[5 - 1] - 0.0099713537367067673*x_hat_r[8 - 1] + 1.9445447659837869*x_hat_r[1 - 1]*(0.0000000000000011644026282695439*ref[1 - 1] - 0.000000000000000068754933253161542*ref[2 - 1] + 0.000000000000000017599558688730133*ref[3 - 1] - 0.55555555555555556*ref[4 - 1]) - 1.9445447659837869*xq0*(2.0171620859552303e-18*ref[1 - 1] + 0.000000000000000012195809172013759*ref[2 - 1] - 0.55555555555555556*ref[3 - 1] + 0.000000000000000017783414524861269*ref[4 - 1]) - 1.9445447659837869*x_hat_r[2 - 1]*(0.5*ref[1 - 1] + 0.000000000000000015518717593798804*ref[2 - 1] - 0.000000000000000027332744408243554*ref[3 - 1] - 0.0000000000000011446064366055788*ref[4 - 1]) - 1.9445447659837869*x_hat_r[3 - 1]*(1.227258482580373e-18*ref[1 - 1] - 0.55555555555555556*ref[2 - 1] - 6.7360524549348324e-18*ref[3 - 1] + 1.9331384768073952e-18*ref[4 - 1]);
    u[2]       = 0.000000000000000020261322258387567*ref[3 - 1] - 8.7016472891861929e-19*ref[2 - 1] - 0.0000000000000010060813477350609*ref[1 - 1] + 0.045229479660937685*ref[4 - 1] - 0.19085893219694816*x_hat_r[6 - 1] + 0.0062502372365556566*x_hat_r[9 - 1] - 2.003714736051275*xq0*(0.0000000000000011644026282695439*ref[1 - 1] - 0.000000000000000068754933253161542*ref[2 - 1] + 0.000000000000000017599558688730133*ref[3 - 1] - 0.55555555555555556*ref[4 - 1]) - 2.003714736051275*x_hat_r[1 - 1]*(2.0171620859552303e-18*ref[1 - 1] + 0.000000000000000012195809172013759*ref[2 - 1] - 0.55555555555555556*ref[3 - 1] + 0.000000000000000017783414524861269*ref[4 - 1]) - 2.003714736051275*x_hat_r[3 - 1]*(0.5*ref[1 - 1] + 0.000000000000000015518717593798804*ref[2 - 1] - 0.000000000000000027332744408243554*ref[3 - 1] - 0.0000000000000011446064366055788*ref[4 - 1]) + 2.003714736051275*x_hat_r[2 - 1]*(1.227258482580373e-18*ref[1 - 1] - 0.55555555555555556*ref[2 - 1] - 6.7360524549348324e-18*ref[3 - 1] + 1.9331384768073952e-18*ref[4 - 1]);
}